import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,b as s,e as i,a as l,w as c,d as a,r as p,o}from"./app-Bpxfipro.js";const r="/assets/cdb_pdb_20240628095050-CwqVi1lz.png",d="/assets/create_cdb_01_20240628103545-BEzmZbj4.png",g="/assets/create_cdb_02_easy_20240628103836-eoI0_9-i.png",h="/assets/create_cdb_03_20240628104400-B_SOacd9.png",_="/assets/create_cdb_04_20240628105423-C9ujieDD.png",u="/assets/create_cdb_05_20240628110104-BhEldm7D.png",b="/assets/create_cdb_07_20240628110505-DhKmad5M.png",m="/assets/create_cdb_09_memory_20240628123716-CQQjM7Dk.png",D="/assets/create_cdb_09_size_20240628123835-Dc6cj5zz.png",f="/assets/create_cdb_09_char_20240628124008-CmdnR5jO.png",B="/assets/create_cdb_09_conn_20240628124026-mkiMIixZ.png",k="/assets/create_cdb_10_20240628124230-B3IOaHXz.png",C="/assets/create_cdb_11_20240628124632-CIOclikA.png",v="/assets/create_cdb_12_20240628124819-CaQLCscw.png",E="/assets/create_cdb_15_20240628134011-DminI7bR.png",P="/assets/create_cdb_15_user_20240628134126-UQxUHjSK.png",y="/assets/create_pdb_01_20240628135713-B-k8cBKz.png",S="/assets/create_pdb_02_20240628135749-DjufD0dl.png",A="/assets/create_pdb_03_20240628135930-DRnxH60Q.png",O="/assets/create_pdb_04_20240628140218-CyOQ-hL0.png",x="/assets/create_pdb_05_20240628140548-DRrNUoGb.png",z="/assets/create_pdb_06_20240628140735-OcQqUqFl.png",R={},T=a('<h2 id="cdb-pdb" tabindex="-1"><a class="header-anchor" href="#cdb-pdb"><span>CDB/PDB</span></a></h2><p>Oracle 在 12C 的多租户架构，引入了 CDB/PDB 的新特性。</p><p>CDB 全称 Container Database，是一个数据库容器，可以容纳多个 PDB。</p><p>PDB 全称 Pluggable Database，是一个可插入数据库，是 CDB 的一部分，通过 CDB 提供服务。</p><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>CDB 和 PDB 的关系就像进程与线程的关系一样，CDB 提供物理资源的隔离，同一个 CDB 里面的 PDB 共享这个 CDB 的资源。PDB 提供逻辑上的隔离，逻辑上 PDB 是一个独立完整的数据库，拥有自己的数据文件和用户表空间等。</p><p>在物理层面上，每个 CDB 是一个完整的数据库实例，包含了 SGA、PGA 和后台程序，在这个 CDB 中的 PDB 共享这个数据库实例的资源。</p><p><strong>数据库实例</strong>（Database Instance）通常指的是 CDB 或者是一个单独的 PDB 在其所在的 CDB 上运行的实例。</p><h2 id="cdb-创建" tabindex="-1"><a class="header-anchor" href="#cdb-创建"><span>CDB 创建</span></a></h2><p>运行开始菜单里的 <strong>Database Configuration Assistant</strong>（DBCA）</p><ol><li><p>数据库操作：创建数据库</p><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>创建模式：创建模式有两种，一种是典型配置，另一种是高级配置。</p><ul><li><p>典型配置：创建一个 CDB 和一个 PDB，并且管理员账号 <code>SYSTEM</code> 和 <code>SYS</code> 的密码都是一样的</p><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这个模式下，点击下一步直接到了概要页面，中间的选项都是使用默认的，可能有一些警告，确认即可。</p></li><li><p>高级配置：可以配置创建数据库实例的配置，创建多个 PDB 等</p></li></ul><p>这里选择高级配置。</p></li><li><p>部署类型：数据库类型选“Oracle 单实例数据库”，模板选“一般用途或数据处理”</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>数据库标识</p><ul><li>全局数据库名：形式一般是 <code>&lt;name&gt;.&lt;domain&gt;</code>，用于在网络中唯一标识 Oracle 数据库实例，用于客户端连接</li><li>SID：形式一般是 <code>&lt;name&gt;</code>，用于操作系统级别唯一标识 Oracle 数据库实例，用于管理和连接数据库实例</li></ul><p>一个 CDB 可以包含零个或多个 PDB，选择“创建空容器数据库”时只创建 CDB 而不创建 PDB，通过调整 “PDB 数” 创建多个 PDB，每个 PDB 的名称不能一样。</p><figure><img src="'+_+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>存储选项：选择“为数据库存储属性使用模板文件”</p><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>快速恢复选项：根据需求选择“指定快速恢复分区”和“启用归档”，可以不选</p></li><li><p>网络配置：选择一个已有的监听器</p><p>建议使用 <code>Net Configuration Assistant</code> 创建监听器并在这里选择。</p><figure><img src="'+b+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Data Vault 选项：根据需求选择是否配置，可以不配置</p></li><li><p>配置选项</p><ol><li><p>内存：使用自动共享内存管理</p><ul><li>SGA (System Global Area)：用于存储数据库实例的共享内存结构，包括数据缓冲区、共享池等</li><li>PGA (Program Global Area)：用于存储每个用户进程或会话的私有内存结构，如排序区、会话内存等</li></ul><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>调整大小</p><figure><img src="'+D+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>字符集：使用 Unicode，国家字符集选 UTF-8</p><figure><img src="'+f+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>连接模式：选择“专用服务器”</p><figure><img src="'+B+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol></li><li><p>管理选项</p></li></ol><p>配置 Enterprise Manager (EM) Database Express 之后，可以通过 <code>https://localhost:5500/em</code> 访问后台监控。</p><div class="hint-container info"><p class="hint-container-title">后台监控地址</p><p>不一定是<code>localhost</code> ，可以是监听器里配置的任一地址</p></div><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="11"><li>用户身份证明</li></ol><p>为 <code>SYS</code>, <code>SYSTEM</code> 以及 <code>PDBADMIN</code> 帐户设置密码，可以选择“所有账户使用同一管理密码”，这样系统的用户都是使用同一个密码。</p><figure><img src="'+C+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="12"><li>创建选项</li></ol><figure><img src="'+v+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="13"><li>概要</li><li>进度页</li><li>完成</li></ol><p>在完成页面，可以点击“口令管理”，解锁和配置系统用户的密码。</p><figure><img src="'+E+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+P+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>注意</strong>，如果这里重新配置了 <code>SYS</code> 和 <code>SYSTEM</code> 用户的密码，需要使用这个新密码，而不是上面步骤 11 设置的密码。</p><p>创建完成后，DBCA 会在系统注册三个服务，分别是 <code>OracleJobScheduler&lt;SID&gt;</code>、<code>OracleService&lt;SID&gt;</code> 和 <code>OracleVssWriter&lt;SID&gt;</code>。</p><h2 id="pdb-创建" tabindex="-1"><a class="header-anchor" href="#pdb-创建"><span>PDB 创建</span></a></h2><p>可以为 CDB 创建多个 PDB，运行开始菜单里的 <strong>Database Configuration Assistant</strong>（DBCA）</p><ol><li><p>数据库操作：选择“管理可插入数据库”</p><figure><img src="'+y+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>管理插接式数据库：选择“创建可插入数据库”</p><figure><img src="'+S+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>选择数据库</p><figure><img src="'+A+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>创建插接式数据库：选择“从另一个 PDB 创建新的可插入数据库”，选择可插入数据库选“PDB$SEED”</p><div class="hint-container info"><p class="hint-container-title">PDB$SEED</p><p><code>PDB$SEED</code> 是一个预定义的 PDB，它包含了 Oracle 提供的一个初始数据库模板。在创建新的 PDB 时，Oracle 会使用 PDB$SEED 作为基础模板，从而快速创建新的 PDB 并使其具备基本的数据库对象和数据字典。</p></div><figure><img src="'+O+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>PDB 标识：填入数据库名，并为这个 PDB 创建一个用户</p><figure><img src="'+x+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>插接式数据库选项：默认即可</p><figure><img src="'+z+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>概要</p></li><li><p>进度页</p></li><li><p>完成</p></li></ol><h2 id="tnsnames-ora" tabindex="-1"><a class="header-anchor" href="#tnsnames-ora"><span>tnsnames.ora</span></a></h2><p>创建完 CDB 后，Oracle 会在 tnsnames.ora 文件加入一条记录，其中 <code>ORCL = (...)</code> 的 <code>ORCL</code> 是一个连接描述符：</p><div class="language-ora line-numbers-mode" data-highlighter="shiki" data-ext="ora" data-title="ora" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ORCL =</span></span>
<span class="line"><span>  (DESCRIPTION =</span></span>
<span class="line"><span>    (ADDRESS = (PROTOCOL = TCP)(HOST = 127.0.0.1)(PORT = 1521))</span></span>
<span class="line"><span>    (CONNECT_DATA =</span></span>
<span class="line"><span>      (SERVER = DEDICATED)</span></span>
<span class="line"><span>      (SERVICE_NAME = orcl)</span></span>
<span class="line"><span>    )</span></span>
<span class="line"><span>  )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以手动加入 PDB 的记录，在 <code>SERVICE_NAME</code> 指定 PDB 的数据库名：</p><div class="language-ora line-numbers-mode" data-highlighter="shiki" data-ext="ora" data-title="ora" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ORCLPDB =</span></span>
<span class="line"><span>  (DESCRIPTION =</span></span>
<span class="line"><span>    (ADDRESS = (PROTOCOL = TCP)(HOST = 127.0.0.1)(PORT = 1521))</span></span>
<span class="line"><span>    (CONNECT_DATA =</span></span>
<span class="line"><span>      (SERVER = DEDICATED)</span></span>
<span class="line"><span>      (SERVICE_NAME = orclpdb)</span></span>
<span class="line"><span>    )</span></span>
<span class="line"><span>  )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="连接数据库" tabindex="-1"><a class="header-anchor" href="#连接数据库"><span>连接数据库</span></a></h2><p>这里介绍使用 Oracle 自带的工具 SQLPlus 来连接数据库，其他工具或软件大同小异。</p>`,35),I=s("code",null,"sqlplus",-1),L=a(`<div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" data-title="cmd" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">C:\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Users</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Administrator</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sqlplus</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">V</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">Plus: Release </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">21.0.0.0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">Version </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">21.3.0.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>sqlplus</code> 连接数据库的命令格式为 <code>sqlplus &lt;username&gt;/&lt;password&gt;@&lt;connect_string&gt;</code>。</p><div class="hint-container caution"><p class="hint-container-title">警告</p><p>不建议在命令行输入 <code>&lt;password&gt;</code>，这会导致密码以明文的方式显示</p></div><p><code>&lt;username&gt;/&lt;password&gt;@&lt;connect_string&gt;</code> 是可以省略的，直接执行 <code>sqlplus</code>，会连接环境变量 <code>ORACLE_SID</code> 定义的数据库实例，并提示输入账号密码进行登录。</p><p><code>&lt;connect_string&gt;</code> 可以是 <a href="#tnsnames-ora">tnsnames.ora 中定义的连接描述符</a>，例如 <code>sqlplus system@ORCL</code>。</p><p><code>&lt;connect_string&gt;</code> 可以是 <code>&lt;host&gt;:&lt;port&gt;/&lt;service_name&gt;</code>，例如 <code>sqlplus system@127.0.0.1:1521/orcl</code>，这在需要连接远程的服务器时非常有用。</p><p>使用 <code>sqlplus / as sysdba</code> 可以以超级管理员的身份登录到环境变量 <code>ORACLE_SID</code> 定义的数据库实例，<code>/</code> 的作用是告诉 SQLPlus 使用操作系统认证（Operating System Authentication）方式登录到 Oracle 数据库。这种方式下，SQLPlus 将使用当前操作系统用户的身份直接连接到数据库，而不需要输入密码。</p><p>如果需要以超级管理员的身份登录到指定的 CDB/PDB，使用 <code>sqlplus /@&lt;connect_string&gt; as sysdba</code>，例如 <code>sqlplus /@ORCL as sysdba</code>。</p><p>执行 <code>sqlplus /nolog</code> 可以启动 SQLPlus 而不进行任何数据库连接，需要连接的时候，使用 <code>connect &lt;username&gt;/&lt;password&gt;@&lt;connnect_string&gt;</code> 进行连接。</p>`,9);function N(q,F){const e=p("RouteLink");return o(),t("div",null,[T,s("p",null,[i("正确"),l(e,{to:"/oracle/quickstart.html#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE"},{default:c(()=>[i("配置环境变量")]),_:1}),i("后，可以直接在 CMD 使用 SQLPlus 工具，即 "),I,i(" 命令：")]),L])}const Q=n(R,[["render",N],["__file","database.html.vue"]]),w=JSON.parse('{"path":"/oracle/database.html","title":"数据库管理","lang":"zh-CN","frontmatter":{"title":"数据库管理","description":"Oracle 21c 的数据库架构，创建数据库的步骤，连接数据库","order":2},"headers":[{"level":2,"title":"CDB/PDB","slug":"cdb-pdb","link":"#cdb-pdb","children":[]},{"level":2,"title":"CDB 创建","slug":"cdb-创建","link":"#cdb-创建","children":[]},{"level":2,"title":"PDB 创建","slug":"pdb-创建","link":"#pdb-创建","children":[]},{"level":2,"title":"tnsnames.ora","slug":"tnsnames-ora","link":"#tnsnames-ora","children":[]},{"level":2,"title":"连接数据库","slug":"连接数据库","link":"#连接数据库","children":[]}],"git":{"createdTime":1719907014000,"updatedTime":1719907014000,"contributors":[{"name":"Ackerven","email":"ackerven@gmail.com","commits":1}]},"readingTime":{"minutes":5.75,"words":1726},"filePathRelative":"oracle/database.md","localizedDate":"2024年7月2日","excerpt":"<h2>CDB/PDB</h2>\\n<p>Oracle 在 12C 的多租户架构，引入了 CDB/PDB 的新特性。</p>\\n<p>CDB 全称 Container Database，是一个数据库容器，可以容纳多个 PDB。</p>\\n<p>PDB 全称 Pluggable Database，是一个可插入数据库，是 CDB 的一部分，通过 CDB 提供服务。</p>\\n<figure><figcaption></figcaption></figure>\\n<p>CDB 和 PDB 的关系就像进程与线程的关系一样，CDB 提供物理资源的隔离，同一个 CDB 里面的 PDB 共享这个 CDB 的资源。PDB 提供逻辑上的隔离，逻辑上 PDB 是一个独立完整的数据库，拥有自己的数据文件和用户表空间等。</p>"}');export{Q as comp,w as data};
